<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="css/style.css">
<title>Global Coffee Health 仪表盘</title>
<script src="js/echarts.min.js"></script>
<style>
.container {
  display: grid;
  grid-template-columns: repeat(3, 1fr); /* 一行三列 */
  gap: 20px;
  padding: 20px;
}
.card {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  padding: 15px;
  text-align: center;
}
.card h3 { margin-bottom: 15px; }
</style>
</head>
<body>

<header>
    <h1>☕ Global Coffee Health</h1>
    <nav>
        <a href="index.html">首页</a>
        <a href="basic.html">受调查者基本情况</a>
        <a href="health.html">健康分析</a>
        <a href="map.html">全球地图</a>
        <a href="category.html">分类分析</a>
    </nav>
</header>

<div class="container">
    <div class="card">
        <h3>平均咖啡摄入量</h3>
        <div id="coffeeChart" style="height:250px;"></div>
    </div>
    <div class="card">
        <h3>平均睡眠时长</h3>
        <div id="sleepChart" style="height:250px;"></div>
    </div>
    <div class="card">
        <h3>平均压力指数</h3>
        <div id="stressChart" style="height:250px;"></div>
    </div>
</div>

<script>
fetch('data/coffee.json')
.then(res => res.json())
.then(data => {
    // 平均值计算
    const coffeeAvg = Math.round(data.reduce((a,b)=>a+b.Coffee_Intake,0)/data.length);
    const sleepAvg = Math.round(data.reduce((a,b)=>a+b.Sleep_Hours,0)/data.length);
    const stressMapping = {'Low':1,'Medium':2,'High':3};
    const stressAvg = Math.round(data.reduce((a,b)=>a+stressMapping[b.Stress_Level],0)/data.length);

    // 静态图表函数
    function createChart(id, value, symbolPath, unit, maxVal){
        let chart = echarts.init(document.getElementById(id));
        chart.setOption({
            tooltip: { show: true, formatter: `{c} ${unit}` },
            xAxis: { type:'value', min:0, max:maxVal, show:false },
            yAxis: { type:'category', data:[''], show:false },
            series:[{
                type:'pictorialBar',
                symbol: 'image://' + symbolPath,
                symbolSize:[60,60],  // 图标加大
                symbolRepeat:true,
                symbolMargin:2,
                label: {
                    show:true,
                    position:'top',
                    formatter: `{c} ${unit}`,
                    fontSize:16
                },
                data:[value]
            }],
            grid: { top:'center', height:180 }
        });
    }

    // 创建三个静态图表
    createChart('coffeeChart', coffeeAvg, 'coffee.png', '杯', coffeeAvg+10);
    createChart('sleepChart', sleepAvg, 'sleep.png', '小时', sleepAvg+10);
    createChart('stressChart', stressAvg, 'stress.png', '级', stressAvg+3);
});
</script>

</body>
</html>
