<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Global Coffee Health 仪表盘</title>
<link rel="stylesheet" href="css/style.css">
<script src="js/echarts.min.js"></script>
</head>
<body>

<header>
    <h1>☕ Global Coffee Health</h1>
    <nav>
        <a href="index.html">首页</a>
         <a href="basic.html">受调查组基本情况</a>
        <a href="health.html">健康分析</a>
        <a href="map.html">全球地图</a>
        <a href="category.html">分类分析</a>
    </nav>
</header>

<div class="container">
    <div class="card">
        <h3>平均咖啡摄入量</h3>
        <p id="kpi-coffee">0</p>
    </div>
    <div class="card">
        <h3>平均睡眠时长</h3>
        <p id="kpi-sleep">0</p>
    </div>
    <div class="card">
        <h3>平均压力指数</h3>
        <p id="kpi-stress">0</p>
    </div>
    <div class="card">
        <h3>平均 BMI</h3>
        <p id="kpi-bmi">0</p>
    </div>
</div>

<script>
fetch('data/coffee.json')
.then(res=>res.json())
.then(data=>{
    let coffeeAvg = (data.reduce((a,b)=>a+b.Coffee_Intake,0)/data.length).toFixed(2);
    let sleepAvg = (data.reduce((a,b)=>a+ b.Sleep_Hours,0)/data.length).toFixed(2);
    let stressMapping = {'Low':1,'Medium':2,'High':3};
    let stressAvg = (data.reduce((a,b)=>a+stressMapping[b.Stress_Level],0)/data.length).toFixed(2);
    let bmiAvg = (data.reduce((a,b)=>a+b.BMI,0)/data.length).toFixed(2);

    document.getElementById('kpi-coffee').innerText = coffeeAvg;
    document.getElementById('kpi-sleep').innerText = sleepAvg;
    document.getElementById('kpi-stress').innerText = stressAvg;
    document.getElementById('kpi-bmi').innerText = bmiAvg;
});
</script>

</body>
</html>
