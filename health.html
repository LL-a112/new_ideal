<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>咖啡摄入与健康指标雷达图</title>
<script src="js/echarts.min.js"></script>
<style>
 
  .chart-container {
    width: 90%;
    max-width: 900px;
    height: 600px;
    margin: 40px auto;
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.1);
  }
  select {
    margin-top: 20px;
    padding: 6px 12px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #ccc;
  }
</style>
</head>
<body>

<h1>☕ 咖啡摄入与健康指标雷达图</h1>

<select id="countrySelect">
  <option value="Australia">Australia</option>
  <option value="Belgium">Belgium</option>
  <option value="Brazil">Brazil</option>
  <option value="Canada">Canada</option>
  <option value="China">China</option>
  <option value="Finland">Finland</option>
  <option value="France">France</option>
  <option value="Germany">Germany</option>
  <option value="India">India</option>
  <option value="Italy">Italy</option>
  <option value="Japan">Japan</option>
  <option value="Mexico">Mexico</option>
  <option value="Netherlands">Netherlands</option>
  <option value="Norway">Norway</option>
  <option value="South Korea">South Korea</option>
  <option value="Spain">Spain</option>
  <option value="Sweden">Sweden</option>
  <option value="Switzerland">Switzerland</option>
  <option value="UK">UK</option>
  <option value="USA">USA</option>
</select>

<div class="chart-container" id="radarChart"></div>

<script>
fetch("data/coffee.json")
  .then(res => res.json())
  .then(data => {

    const indicators = [
      { name: 'Sleep Hours', max: 12 },
      { name: 'BMI', max: 40 },
      { name: 'Stress Index', max: 5 },
      { name: 'Caffeine mg', max: 500 }
    ];

    const chart = echarts.init(document.getElementById('radarChart'));

    function renderRadar(country) {
      const items = data.filter(d => d.Country === country);
      if(items.length === 0) return;

      // 取平均值
      const avgSleep = items.reduce((a,b)=>a+b.Sleep_Hours,0)/items.length;
      const avgBMI = items.reduce((a,b)=>a+b.BMI,0)/items.length;
      const avgStress = items.reduce((a,b)=>a+b.Stress_Index,0)/items.length;
      const avgCaffeine = items.reduce((a,b)=>a+b.Caffeine_mg,0)/items.length;

      const option = {
        title: { text: country + ' 咖啡与健康指标', left: 'center', top: 10 },
        tooltip: {},
        radar: { indicator: indicators, shape: 'polygon' },
        series: [{
          type: 'radar',
          data: [{
            value: [avgSleep, avgBMI, avgStress, avgCaffeine],
            name: country,
            areaStyle: { color: 'rgba(79, 129, 189, 0.3)' },
            lineStyle: { color: '#4f81bd', width: 2 },
            symbol: 'circle',
            symbolSize: 8
          }]
        }]
      };
      chart.setOption(option);
    }

    // 初始显示第一个国家
    const select = document.getElementById('countrySelect');
    renderRadar(select.value);

    // 下拉切换
    select.addEventListener('change', e => renderRadar(e.target.value));
  });
</script>

</body>
</html>
